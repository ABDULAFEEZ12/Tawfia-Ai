<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Tawfiq AI - Smart Islamic Companion</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Internal CSS for styling -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f4f4f4;
  color: #333;
  display: flex;
  flex-direction: column;
  height: 100vh; /* Full viewport height for layout */
  overflow: hidden;
}

/* Header styles */
h1, h3 {
  text-align: center;
  margin: 20px 10px;
  font-weight: 600;
}
header h1 {
  font-size: 1.8em;
  color: #222;
}
header h3 {
  font-size: 1.2em;
  color: #555;
}

/* Menu toggle button */
#menu-toggle {
  font-size: 28px;
  cursor: pointer;
  position: fixed;
  top: 20px;
  left: 15px;
  z-index: 1001;
  background: #fff;
  padding: 8px 12px;
  border-radius: 10px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
}
#menu-toggle:hover {
  background: #eee;
  transform: scale(1.05);
}

/* Sidebar menu styles */
#side-menu {
  position: fixed;
  top: 0;
  left: 0;
  width: 280px;
  height: 100%;
  background-color: #121212;
  color: #fff;
  padding-top: 70px;
  transition: all 0.3s ease;
  z-index: 1000;
  overflow-y: auto;
  border-top-right-radius: 12px;
  border-bottom-right-radius: 12px;
}
#side-menu.hidden {
  left: -280px;
}
#side-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
#side-menu li {
  padding: 16px 20px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  font-size: 1em;
  transition: background 0.2s, transform 0.1s;
}
#side-menu li:hover {
  background-color: #333;
  transform: translateX(2px);
}

/* Tabs styles */
.tabs {
  margin-top: 100px;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 12px;
}
.tab {
  padding: 10px 20px;
  border-radius: 25px;
  background-color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  cursor: pointer;
  font-weight: 600;
  font-size: 1em;
  transition: background 0.3s, transform 0.2s;
}
.tab.active, .tab:hover {
  background-color: #ddd;
  transform: scale(1.02);
}

/* Sections styling */
.section {
  display: none;
  padding: 20px;
  max-width: 700px;
  margin: 20px auto;
  background-color: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  width: 100%;
}
.section.active {
  display: block;
}

/* AI chat container: full height, flex column */
#aiSection {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 180px);
  margin: 20px;
}

/* Messages area: scrollable, above input */
#messages {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
  background: #fff;
  border-radius: 8px;
  margin-bottom: 10px;
}
#messages::-webkit-scrollbar {
  width: 8px;
}
#messages::-webkit-scrollbar-thumb {
  background-color: rgba(0,0,0,0.2);
  border-radius: 4px;
}
#messages::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0,0,0,0.4);
}

/* Input container fixed at bottom of AI section */
#aiInputContainer {
  display: flex;
  padding: 10px;
  background-color: #fff;
  border-top: 1px solid #ccc;
  align-items: center;
}
#userInput {
  flex: 1;
  padding: 12px 15px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-family: 'Poppins', sans-serif;
  font-size: 1em;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
}
#askButton {
  margin-left: 8px;
  padding: 12px 20px;
  border: none;
  border-radius: 8px;
  background-color: #007bff;
  color: #fff;
  font-size: 1em;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: background 0.3s, transform 0.2s;
}
#askButton:hover {
  background-color: #0056b3;
  transform: scale(1.02);
}

/* Styles for other sections like Quran and Hadith */
#quranSection, #hadithSection {
  display: none;
}
#quranSection.active, #hadithSection.active {
  display: block;
}

/* Dropdown styles */
select {
  width: 100%;
  padding: 12px 15px;
  margin-top: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-family: 'Poppins', sans-serif;
  font-size: 1em;
  background-color: #fff;
}

/* Results styling */
.results {
  margin-top: 20px;
  background-color: #f9f9f9;
  padding: 15px;
  border-radius: 10px;
  max-height: 300px;
  overflow-y: auto;
}
.results::-webkit-scrollbar {
  width: 8px;
}
.results::-webkit-scrollbar-thumb {
  background-color: rgba(0,0,0,0.2);
  border-radius: 4px;
}
.results::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0,0,0,0.4);
}

/* Responsive adjustments */
@media(max-width: 600px) {
  body {
    font-size: 0.95em;
  }
  header h1 {
    font-size: 1.4em;
  }
  header h3 {
    font-size: 1em;
  }
  #menu-toggle {
    font-size: 24px;
    padding: 6px 10px;
  }
  .tab {
    padding: 8px 16px;
    font-size: 0.95em;
  }
  button {
    padding: 10px 16px;
    font-size: 0.95em;
  }
}
</style>
</head>
<body>

<!-- MENU TOGGLE BUTTON -->
<div id="menu-toggle" onclick="toggleMenu()">‚ò∞</div>

<!-- SIDEBAR MENU -->
<div id="side-menu" class="hidden">
  <ul>
    <li onclick="goTo('profile')">üë§ Profile</li>
    <li onclick="goTo('prayerTimes')">üïå Prayer Times</li>
    <li onclick="goTo('dailyDuaMenu')">üïå Daily Dua</li>
    <li onclick="goTo('reminder')">üìÖ Daily Reminder</li>
    <li onclick="goTo('motivation')">‚ú® Islamic Motivation</li>
    <li onclick="goTo('settings')">‚öôÔ∏è Settings</li>
    <li onclick="goTo('privacy')">üîí Privacy & Policy</li>
    <li onclick="goTo('about')">‚ÑπÔ∏è About Tawfiq AI</li>
    <li onclick="goTo('feedback')">üì¢ Feedback / Report</li>
  </ul>
</div>

<!-- Toggle Mode Button -->
<button class="toggle-btn" onclick="toggleMode()">Toggle Mode</button>

<!-- Main Header -->
<header>
<h1>üåô Tawfiq AI - Smart Islamic Companion üåô</h1>
<h3>‚ú® Ask me anything about Islam ‚ú®</h3>
</header>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="switchTab('aiSection', event)">ü§ñ AI</div>
  <div class="tab" onclick="switchTab('quranSection', event)">üìñ Quran</div>
  <div class="tab" onclick="switchTab('hadithSection', event)">üìú Hadith</div>
</div>

<!-- AI Chat Section with input fixed at bottom -->
<div class="section active" id="aiSection" style="display:flex; flex-direction:column; height: calc(100vh - 180px);">
  <!-- Messages container -->
  <div id="messages" style="flex:1; overflow-y:auto; padding:10px; background:#fff; border-radius:8px;">
    <!-- Chat messages will appear here -->
  </div>
  <!-- Input fixed at bottom -->
  <div id="aiInputContainer" style="display:flex; padding:10px; background:#fff; border-top:1px solid #ccc;">
    <input type="text" id="userInput" placeholder="Ask a question about Islam..." style="flex:1; padding:12px 15px; border-radius:8px; border:1px solid #ccc; font-family:'Poppins',sans-serif; font-size:1em; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);"/>
    <button id="askButton" onclick="sendQuestion()" style="margin-left:8px; padding:12px 20px; border:none; border-radius:8px; background-color:#007bff; color:#fff; font-size:1em; cursor:pointer; box-shadow:0 2px 4px rgba(0,0,0,0.2); transition:background 0.3s, transform 0.2s;">Ask</button>
  </div>
</div>

<!-- Quran Section -->
<div class="section" id="quranSection">
  <h3>Quran - Select Surah</h3>
  <select id="surahDropdown" onchange="searchQuran()">
    <option value="">-- Select Surah --</option>
  </select>
  <div class="results" id="quranResult"></div>
</div>

<!-- Hadith Section -->
<div class="section" id="hadithSection">
  <h3>Hadith - Select Topic</h3>
  <select id="hadithDropdown" onchange="searchHadith()">
    <option value="">-- Select Hadith Topic --</option>
  </select>
  <div class="results" id="hadithResult"></div>
</div>

<!-- Scripts -->
<script>
  let chatHistory = [];

  // Load Surah list into Quran dropdown
  function loadSurahList() {
    const surahs = [
      "Al-Fatihah", "Al-Baqarah", "Aali Imran", "An-Nisa", "Al-Maidah", "Al-Anam",
      // ... add all surahs as needed
      "Al-Nas"
    ];
    const select = document.getElementById('surahDropdown');
    surahs.forEach(surah => {
      const option = document.createElement('option');
      option.value = surah;
      option.textContent = surah;
      select.appendChild(option);
    });
  }

  // Load Hadith Topics
  function loadHadithTopics() {
    const topics = [
      "Hadith on Prayer", "Hadith on Faith", "Hadith on Charity", "Hadith on Patience",
      // ... add more topics as needed
      "Family Ties"
    ];
    const select = document.getElementById('hadithDropdown');
    topics.forEach(topic => {
      const option = document.createElement('option');
      option.value = topic;
      option.textContent = topic;
      select.appendChild(option);
    });
  }

  // Switch tabs
  function switchTab(sectionId, event) {
    document.querySelectorAll('.section').forEach(s => s.style.display='none');
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(sectionId).style.display='block';
    event.target.classList.add('active');
  }

  function toggleMenu() {
    document.getElementById('side-menu').classList.toggle('hidden');
  }

  function toggleMode() {
    document.body.classList.toggle('light-mode');
    document.body.classList.toggle('dark-mode');
    const toggleBtn = document.querySelector('.toggle-btn');
    toggleBtn.textContent = document.body.classList.contains('dark-mode') ? 'Toggle Light Mode' : 'Toggle Dark Mode';
  }

  // Send question
async function sendQuestion() {
  const inputEl = document.getElementById("userInput");
  const question = inputEl.value.trim();
  if (!question) return;

  const container = document.getElementById("messages");
  const userMsg = document.createElement("div");
  userMsg.className = "message user";
  userMsg.innerHTML = "<strong>You:</strong> " + question;
  container.appendChild(userMsg);
  inputEl.value = "";
  container.scrollTop = container.scrollHeight;

  chatHistory.push({ role: "user", content: question });
  const loadingMsg = document.createElement("div");
  loadingMsg.className = "message ai loading-indicator";
  loadingMsg.innerText = "Tawfiq AI is thinking...";
  container.appendChild(loadingMsg);
  container.scrollTop = container.scrollHeight;

  try {
    const response = await fetch('/ask', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ history: chatHistory })
    });
    const data = await response.json();
    container.removeChild(loadingMsg);
    const answer = data.answer || "Sorry, couldn't answer.";
    chatHistory.push({ role: "assistant", content: answer });
    const aiMsg = document.createElement("div");
    aiMsg.className = "message ai";
    aiMsg.innerHTML = "Tawfiq AI: " + answer.replace(/\n/g, '<br>');
    container.appendChild(aiMsg);
    container.scrollTop = container.scrollHeight;
  } catch (err) {
    console.error(err);
    container.removeChild(loadingMsg);
    const errorMsg = document.createElement("div");
    errorMsg.className = "message ai";
    errorMsg.innerText = "Tawfiq AI: Error getting response.";
    container.appendChild(errorMsg);
    container.scrollTop = container.scrollHeight;
  }
}

// Quran search when selecting a surah
function searchQuran() {
  const surahSelect = document.getElementById("surahDropdown");
  const selectedSurah = surahSelect.value;
  const resultDiv = document.getElementById("quranResult");
  if (!selectedSurah) return;
  resultDiv.innerHTML = `<div class="user-message">Searching Surah: ${selectedSurah}</div>`;
  // Fetch or display content related to selected surah
  // For demo, just show the surah name
  resultDiv.innerHTML += `<div>Display content for ${selectedSurah} here.</div>`;
}

// Hadith search when selecting topic
function searchHadith() {
  const topicSelect = document.getElementById("hadithDropdown");
  const selectedTopic = topicSelect.value;
  const resultDiv = document.getElementById("hadithResult");
  if (!selectedTopic) return;
  resultDiv.innerHTML = `<div class="user-message">Searching Hadith: ${selectedTopic}</div>`;
  // Fetch or display content related to selected topic
  // For demo, just show the topic name
  resultDiv.innerHTML += `<div>Display Hadiths about ${selectedTopic} here.</div>`;
}

// Load lists on page load
document.addEventListener("DOMContentLoaded", () => {
  loadSurahList();
  loadHadithTopics();
});
</script>
</body>
</html>
