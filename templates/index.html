<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Tawfiq AI - Smart Islamic Companion</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- External CSS (if any) -->
<!-- <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"> -->

<!-- Internal CSS for styling -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f4f4f4;
  color: #333;
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-x: hidden;
}

/* Headings */
h1, h3 {
  text-align: center;
  margin: 20px 10px;
  font-weight: 600;
}
header h1 {
  font-size: 1.8em;
  color: #222;
}
header h3 {
  font-size: 1.2em;
  color: #555;
}

/* Menu toggle button */
#menu-toggle {
  font-size: 28px;
  cursor: pointer;
  position: fixed;
  top: 20px;
  left: 15px;
  z-index: 1001;
  background: #fff;
  padding: 8px 12px;
  border-radius: 10px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
}
#menu-toggle:hover {
  background: #eee;
  transform: scale(1.05);
}

/* Sidebar menu */
#side-menu {
  position: fixed;
  top: 0;
  left: 0;
  width: 280px;
  height: 100%;
  background-color: #121212;
  color: #fff;
  padding-top: 70px;
  transition: all 0.3s ease;
  z-index: 1000;
  overflow-y: auto;
  border-top-right-radius: 12px;
  border-bottom-right-radius: 12px;
}
#side-menu.hidden {
  left: -280px;
}
#side-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
#side-menu li {
  padding: 16px 20px;
  border-bottom: 1px solid #333;
  cursor: pointer;
  font-size: 1em;
  transition: background 0.2s, transform 0.1s;
}
#side-menu li:hover {
  background-color: #333;
  transform: translateX(2px);
}
#side-menu a {
  color: inherit;
  text-decoration: none;
  display: block;
}

/* Tabs styling */
.tabs {
  margin-top: 100px;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 12px;
}
.tab {
  padding: 10px 20px;
  border-radius: 25px;
  background-color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  cursor: pointer;
  font-weight: 600;
  font-size: 1em;
  transition: background 0.3s, transform 0.2s;
}
.tab.active, .tab:hover {
  background-color: #ddd;
  transform: scale(1.02);
}

/* Sections */
.section {
  display: none;
  padding: 20px;
  max-width: 700px;
  margin: 0 auto;
  background-color: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  margin-top: 20px;
  width: 100%;
}
.section.active {
  display: block;
}

/* Input styles */
input[type="text"], select {
  width: 100%;
  padding: 12px 15px;
  margin-top: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 1em;
  font-family: 'Poppins', sans-serif;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  transition: border-color 0.2s;
}
input[type="text"]:focus, select:focus {
  border-color: #007bff;
  outline: none;
}

/* Buttons */
button {
  margin-top: 12px;
  padding: 12px 20px;
  border: none;
  border-radius: 8px;
  background-color: #007bff;
  color: #fff;
  font-size: 1em;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  transition: background 0.3s, transform 0.2s;
}
button:hover {
  background-color: #0056b3;
  transform: scale(1.02);
}

/* Chat message containers */
.message-container {
  display: flex;
  margin-bottom: 10px;
}

/* User message: right aligned, green bubbles */
.user-message {
  justify-content: flex-end;
}
.user-bubble {
  background-color: #DCF8C6; /* WhatsApp greenish */
  color: #000;
  border-radius: 20px;
  padding: 10px 15px;
  max-width: 70%;
  font-family: 'Poppins', sans-serif;
  font-size: 1em;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  font-weight: normal;
}

/* Tawfiq AI message: left aligned, white/blue bubbles, bold */
.ai-message {
  justify-content: flex-start;
}
.ai-bubble {
  background-color: #ffffff;
  color: #000;
  border-radius: 20px;
  padding: 10px 15px;
  max-width: 70%;
  font-family: 'Poppins', sans-serif;
  font-size: 1em;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  font-weight: bold;
}

/* Messages and results containers */
.messages, .results {
  margin-top: 20px;
  background-color: #fff;
  padding: 15px;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  max-height: 300px;
  overflow-y: auto;
  font-family: 'Poppins', sans-serif;
}
.user-message {
  font-weight: 600;
  margin-bottom: 10px;
}
.loading-indicator {
  font-style: italic;
  color: #555;
}

/* Scrollbar styling for WebKit browsers */
::-webkit-scrollbar {
  width: 8px;
}
::-webkit-scrollbar-thumb {
  background-color: rgba(0,0,0,0.2);
  border-radius: 4px;
}
::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0,0,0,0.4);
}

/* Firefox scrollbar */
body {
  scrollbar-width: thin;
  scrollbar-color: rgba(0,0,0,0.2) transparent;
}

/* Responsive adjustments */
@media(max-width: 600px) {
  body {
    font-size: 0.95em;
  }
  header h1 {
    font-size: 1.4em;
  }
  header h3 {
    font-size: 1em;
  }
  #menu-toggle {
    font-size: 24px;
    padding: 6px 10px;
  }
  .tab {
    padding: 8px 16px;
    font-size: 0.95em;
  }
  button {
    padding: 10px 16px;
    font-size: 0.95em;
  }
}
</style>
</head>
<body>

<!-- MENU TOGGLE BUTTON -->
<div id="menu-toggle" onclick="toggleMenu()">‚ò∞</div>

<!-- SIDEBAR MENU -->
<div id="side-menu" class="hidden">
  <ul>
    <li><a href="/profile">üë§ Profile</a></li>
    <li><a href="/prayer-times">üïå Prayer Times</a></li>
    <li><a href="/daily-dua">üïå Daily Dua</a></li>
    <li><a href="/reminder">üìÖ Daily Reminder</a></li>
    <li><a href="/motivation">‚ú® Islamic Motivation</a></li>
    <li><a href="/settings">‚öôÔ∏è Settings</a></li>
    <li><a href="/privacy">üîí Privacy & Policy</a></li>
    <li><a href="/about">‚ÑπÔ∏è About Tawfiq AI</a></li>
    <li><a href="/feedback">üì¢ Feedback / Report</a></li>
  </ul>
</div>

<!-- Toggle Mode Button -->
<button class="toggle-btn" onclick="toggleMode()">Toggle Mode</button>

<!-- Main Header -->
<header>
<h1>üåô Tawfiq AI - Smart Islamic Companion üåô</h1>
<h3>‚ú® Ask me anything about Islam ‚ú®</h3>
</header>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="switchTab('aiSection', event)">ü§ñ AI</div>
  <div class="tab" onclick="switchTab('quranSection', event)">üìñ Quran</div>
  <div class="tab" onclick="switchTab('hadithSection', event)">üìú Hadith</div>
</div>

<!-- AI Chat Section -->
<div class="section active" id="aiSection">
  <div class="messages" id="messages"></div>
  <input type="text" id="userInput" placeholder="Ask about Islam..." />
  <button onclick="sendQuestion()">Ask</button>
</div>

<!-- Quran Search -->
<div class="section" id="quranSection">
  <input type="text" id="quranInput" placeholder="Enter Surah or keyword..." />
  <select id="surahList">
    <option value="">-- Or Select Surah --</option>
  </select>
  <button onclick="searchQuran()">Search Surah</button>
  <div class="results" id="quranResult"></div>
</div>

<!-- Hadith Search -->
<div class="section" id="hadithSection">
  <input type="text" id="hadithInput" placeholder="Enter Hadith keyword or number..." />
  <select id="hadithDropdown">
    <option value="">-- Or Select Hadith Topic --</option>
  </select>
  <button onclick="searchHadith()">Search Hadith</button>
  <div class="results" id="hadithResult"></div>
</div>

<!-- Dua & Motivation Sections -->
<div class="section" id="duaSection">
  <h3>Today's Dua</h3>
  <div id="duaText">Loading Dua...</div>
  <div id="dailyDuaSection">
    <h2>üïå Daily Dua üìø</h2>
    <div id="dailyDuaContent" style="font-size: 1.2em; padding: 10px; text-align: center;">Loading the Dua of the Day...</div>
  </div>
</div>

<div class="section" id="motivationSection">
  <h3>Daily Motivation</h3>
  <div id="motivationText">Loading Motivation...</div>
</div>

<!-- Prayer Times -->
<div class="section" id="prayerTimes" style="display:none;">
  <h3>üïå Prayer Times</h3>
  <div id="prayerTimesContent" style="padding: 10px;">
    <p>Loading prayer times...</p>
  </div>
</div>

<!-- Daily Dua Menu -->
<div class="section" id="dailyDuaMenu" style="display:none;">
  <h3>üïå Daily Dua üìø</h3>
  <div id="dailyDuaContentMenu" style="font-size: 1.2em; padding: 10px; text-align: center;">Loading the Dua of the Day...</div>
</div>

<script>
  // Surah list
  const surahs = [
    "Al-Fatihah", "Al-Baqarah", "Aali Imran", "An-Nisa", "Al-Maidah", "Al-Anam", "Al-Araf",
    "Al-Anfal", "At-Tawbah", "Yunus", "Hud", "Yusuf", "Ar-Rad", "Ibrahim", "Al-Hijr",
    "An-Nahl", "Al-Isra", "Al-Kahf", "Maryam", "Ta-Ha", "Al-Anbiya", "Al-Hajj", "Al-Muminun",
    "An-Nur", "Al-Furqan", "Ash-Shuara", "An-Naml", "Al-Qasas", "Al-Ankabut", "Ar-Rum",
    "Luqman", "As-Sajda", "Al-Ahzab", "Saba", "Fatr", "Ya-Sin", "As-Saffat", "Sad",
    "Az-Zumar", "Ghafir", "Fussilat", "Ash-Shura", "Az-Zukhruf", "Ad-Dukhan", "Al-Jathiya",
    "Al-Ahqaf", "Muhammad", "Al-Fath", "Al-Hujurat", "Qaf", "Adh-Dhariyat", "At-Tur",
    "An-Najm", "Al-Qamar", "Ar-Rahman", "Al-Waqi'a", "Al-Hadid", "Al-Mujadila", "Al-Hashr",
    "Al-Mumtahanah", "As-Saff", "Al-Jumu'a", "Al-Munafiqun", "At-Taghabun", "At-Talaq",
    "At-Tahrim", "Al-Mulk", "Al-Qalam", "Al-Haqqah", "Al-Ma'arij", "Nuh", "Al-Jinn",
    "Al-Muzzammil", "Al-Muddathir", "Al-Qiyama", "Al-Insan", "Al-Mursalat", "An-Naba",
    "An-Nazi'at", "Abasa", "At-Takwir", "Al-Infitar", "Al-Mutaffifin", "Al-Inshiqaq",
    "Al-Buruj", "At-Tariq", "Al-Ala", "Al-Ghashiyah", "Al-Fajr", "Al-Balad", "Ash-Shams",
    "Al-Lail", "Ad-Duha", "Ash-Sharh", "At-Tin", "Al-Alaq", "Al-Qadr", "Al-Bayyina",
    "Az-Zalzalah", "Al-Adiyat", "Al-Qari'a", "At-Takathur", "Al-Asr", "Al-Humazah",
    "Al-Fil", "Quraysh", "Al-Ma'un", "Al-Kawthar", "Al-Kafirun", "An-Nasr", "Al-Masad",
    "Al-Ikhlas", "Al-Falaq", "An-Nas"
  ];

  // Common Hadith topics
  const hadithTopics = [
    "Prayer", "Faith", "Charity", "Patience", "Gratitude", "Kindness", "Fasting", "Hajj",
    "Honesty", "Forgiveness", "Parents", "Children", "Marriage", "Neighbors", "Brotherhood",
    "Modesty", "Repentance", "Mercy", "Humility", "Envy", "Justice", "Knowledge", "Dua",
    "Quran", "Sunnah", "Hellfire", "Paradise", "Backbiting", "Lying", "Trust", "Trade",
    "Wealth", "Poverty", "Oppression", "Manners", "Sincerity", "Innovation", "Angels",
    "Jinn", "Death", "Resurrection", "Signs of Judgment", "Health", "Cleanliness", "Generosity",
    "Bribery", "Gossip", "Leadership", "Love", "Peace", "Night Prayer", "Ablution", "Zakat",
    "Seeking Knowledge", "Good Deeds", "Evil Deeds", "Hypocrisy", "Arrogance", "Tawheed",
    "Shirk", "Respecting Elders", "Youth", "Orphans", "Widows", "Dressing Modestly",
    "Halal and Haram", "Gossip", "Anger", "Smiling", "Good Speech", "Contentment",
    "Worldly Life", "Akhirah", "Thankfulness", "Seeking Forgiveness", "Trials", "Visiting Graves",
    "Trust in Allah", "Destiny", "Martyrdom", "Courage", "Sin", "Purification", "Eid", "Sacrifice",
    "Brotherhood in Islam", "Leadership in Islam", "Reciting Quran", "Betrayal", "Piety",
    "Remembrance of Allah", "Friday Prayer", "Allah‚Äôs Mercy", "Night of Qadr", "Family Ties"
  ];

  // Populate Surah dropdown
  const surahSelect = document.getElementById('surahList');
  surahs.forEach(s => {
    const option = document.createElement('option');
    option.value = s;
    option.textContent = s;
    surahSelect.appendChild(option);
  });

  // Populate Hadith topics dropdown
  const hadithSelect = document.getElementById('hadithDropdown');
  hadithTopics.forEach(t => {
    const option = document.createElement('option');
    option.value = t;
    option.textContent = t;
    hadithSelect.appendChild(option);
  });

  // ... (rest of your existing script functions) ...

  function switchTab(sectionId, event) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
    event.target.classList.add('active');
  }

  function toggleMode() {
    document.body.classList.toggle('light-mode');
    document.body.classList.toggle('dark-mode');
    document.querySelector('.toggle-btn').textContent = document.body.classList.contains('dark-mode') ? 'Toggle Light Mode' : 'Toggle Dark Mode';
  }

  function toggleMenu() {
    document.getElementById('side-menu').classList.toggle('hidden');
  }

  // Load Daily Dua
  function loadDailyDua() {
    fetch('data/daily_duas.json')
      .then(res => res.json())
      .then(data => {
        const dua = data.dua || "No Dua available.";
        document.getElementById('dailyDuaContent').innerHTML = `<p>"${dua}"</p>`;
        document.getElementById('dailyDuaContentMenu').innerHTML = `<p>"${dua}"</p>`;
      }).catch(() => {
        document.getElementById('dailyDuaContent').innerHTML = '<p>Unable to load Dua for today.</p>';
        document.getElementById('dailyDuaContentMenu').innerHTML = '<p>Unable to load Dua for today.</p>';
      });
  }

  // Load prayer times
  function loadPrayerTimes() {
    fetch('/get-prayer-times')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('prayerTimesContent');
        if (data && data.prayer_times) {
          container.innerHTML = '';
          for (const [name, time] of Object.entries(data.prayer_times)) {
            const p = document.createElement('p');
            p.innerHTML = `<strong>${name}:</strong> ${time}`;
            container.appendChild(p);
          }
        } else {
          container.innerHTML = '<p>Prayer times data unavailable.</p>';
        }
      }).catch(() => {
        document.getElementById('prayerTimesContent').innerHTML = '<p>Error loading prayer times.</p>';
      });
  }

  // Send question (with streaming concept)
async function sendQuestion() {
  const inputEl = document.getElementById("userInput");
  const question = inputEl.value.trim();
  if (!question) return;

  const messagesDiv = document.getElementById("messages");

  // User message right-aligned (green bubble)
  const userMsg = document.createElement("div");
  userMsg.className = "message-container user-message";
  const userBubble = document.createElement("div");
  userBubble.className = "user-bubble";
  userBubble.innerHTML = "You: <b>" + question + "</b>";
  userMsg.appendChild(userBubble);
  messagesDiv.appendChild(userMsg);

  inputEl.value = "";
  messagesDiv.scrollTop = messagesDiv.scrollHeight;

  // Append user message to chat history
  chatHistory.push({ role: "user", content: question });

  // Show loading indicator
  const loading = document.createElement("p");
  loading.className = "loading-indicator";
  loading.textContent = "Tawfiq AI is thinking...";
  messagesDiv.appendChild(loading);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;

  try {
    // Example API call (conceptual)
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer YOUR_OPENROUTER_API_KEY"
      },
      body: JSON.stringify({
        model: "openai/gpt-3.5-turbo",
        messages: [...chatHistory],
        stream: true
      })
    });
    // For stream, you'd handle response.body.getReader() here
    // For simplicity, assuming response.json()
    const data = await response.json();

    // Remove loading
    messagesDiv.removeChild(loading);

    // Append AI message (left aligned, bold)
    const aiMsg = document.createElement("div");
    aiMsg.className = "message-container ai-message";
    const aiBubble = document.createElement("div");
    aiBubble.className = "ai-bubble";
    aiBubble.innerHTML = "Tawfiq AI: <b>" + (data.answer || "Sorry, couldn't answer.") + "</b>";
    aiMsg.appendChild(aiBubble);
    messagesDiv.appendChild(aiMsg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;

    // Save answer to chat history
    chatHistory.push({ role: "assistant", content: data.answer });
  } catch (err) {
    console.error(err);
    messagesDiv.removeChild(loading);
    const errorMsg = document.createElement("div");
    errorMsg.className = "message-container ai-message";
    const errorBubble = document.createElement("div");
    errorBubble.className = "ai-bubble";
    errorBubble.innerHTML = "Tawfiq AI: <b>Error getting response.</b>";
    errorMsg.appendChild(errorBubble);
    messagesDiv.appendChild(errorMsg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }
}

// Other functions (searchQuran, searchHadith) follow similar pattern, omitted here for brevity

</script>
</body>
</html>
