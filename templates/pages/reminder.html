<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tawfiq AI - Islamic Reminders</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #e0f2f1;
      padding: 30px 20px;
      margin: 0;
      text-align: center;
    }

    h1 {
      color: #00695c;
      margin-bottom: 30px;
    }

    .reminder-box {
      background: linear-gradient(145deg, #ffffff, #d7fce6);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      padding: 40px 25px;
      border-radius: 20px;
      max-width: 600px;
      margin: auto;
      font-size: 1.4rem;
      color: #004d40;
      line-height: 1.8;
      transition: all 0.3s ease;
      min-height: 200px;
      overflow-y: auto;
      max-height: 450px;
      display: none;
      position: relative;
    }

    .reminder-box.active {
      display: block;
    }

    .reminder-category {
      font-weight: bold;
      font-size: 1.2rem;
      color: #00796b;
      margin-bottom: 15px;
    }

    .reminder-reference {
      margin-top: 25px;
      font-size: 1.1rem;
      color: #555;
      font-style: italic;
    }

    .button-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 30px;
      gap: 15px;
    }

    button, .btn {
      background-color: #009688;
      color: white;
      border: none;
      padding: 14px 28px;
      font-size: 1rem;
      border-radius: 10px;
      cursor: pointer;
      text-decoration: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s ease;
    }

    button:hover, .btn:hover {
      background-color: #00796b;
    }

    .no-print {
      display: inline-block;
    }

    @media print {
      .no-print {
        display: none !important;
      }
    }

    @media (max-width: 480px) {
      .reminder-box {
        padding: 30px 18px;
        font-size: 1.1rem;
      }

      button {
        padding: 12px 24px;
      }
    }
  </style>
</head>
<body>

  <h1>üåô Today's Islamic Reminders</h1>

  <div id="reminders-container">
    {% for reminder in reminders %}
    <div class="reminder-box {% if loop.first %}active{% endif %}" id="reminder-{{ loop.index0 }}">
      <div class="reminder-category">{{ reminder.category }}</div>
      <div class="reminder-text">{{ reminder.text }}</div>
      <div class="reminder-reference">{{ reminder.reference }}</div>

      <div class="button-group no-print">
        <button onclick="downloadReminder('reminder-{{ loop.index0 }}')">Download üì•</button>
        {% if not loop.last %}
        <button onclick="showNextReminder({{ loop.index0 }})">Next Reminder ‚û°Ô∏è</button>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- html2canvas for screenshot download -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    function showNextReminder(currentIndex) {
      const current = document.getElementById(`reminder-${currentIndex}`);
      const next = document.getElementById(`reminder-${currentIndex + 1}`);
      if (next) {
        current.classList.remove('active');
        next.classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    }

    function downloadReminder(id) {
      const element = document.getElementById(id);

      // Hide interactive buttons
      const buttons = element.querySelectorAll('.no-print');
      buttons.forEach(btn => btn.style.display = 'none');

      // Create temporary watermark
      const watermark = document.createElement('div');
      watermark.innerText = "Tawfiq AI üìø - www.tawfiqai.com";
      watermark.style.position = "absolute";
      watermark.style.bottom = "15px";
      watermark.style.right = "20px";
      watermark.style.opacity = "1";
      watermark.style.fontSize = "1rem";
      watermark.style.fontWeight = "bold";
      watermark.style.fontFamily = "Segoe UI, sans-serif";
      watermark.style.color = "#004d40";
      watermark.classList.add("temp-watermark");

      // Add watermark only for the screenshot
      element.appendChild(watermark);

      html2canvas(element).then(canvas => {
        const link = document.createElement('a');
        link.download = `${id}_Tawfiq_Reminder.png`;
        link.href = canvas.toDataURL("image/png");
        link.click();

        // Show buttons again and remove watermark
        buttons.forEach(btn => btn.style.display = 'inline-block');
        watermark.remove();
      });
    }
  </script>
</body>
</html>
